(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();function I({productList:e,selectedItemId:o}){return e.find(t=>t.id===o)}const v=e=>e&&e.quantity>0,E=({curQuantity:e,quantityOffset:o,productQuantity:t})=>{const a=e+o;return a>0&&a<=t+e},C=30,r=.25,q={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},u=[{id:"p1",name:"상품1",value:1e4,quantity:50},{id:"p2",name:"상품2",value:2e4,quantity:30},{id:"p3",name:"상품3",value:3e4,quantity:20},{id:"p4",name:"상품4",value:15e3,quantity:0},{id:"p5",name:"상품5",value:25e3,quantity:10}];let s=0,m;function b(){B(),p(),f(),h(),y(),setTimeout(function(){setInterval(function(){const t=u[Math.floor(Math.random()*u.length)];Math.random()<.3&&t.quantity>0&&(t.value=Math.round(t.value*.8),alert("번개세일! "+t.name+"이(가) 20% 할인 중입니다!"),p())},3e4)},Math.random()*1e4),setTimeout(function(){setInterval(function(){if(m){const t=u.find(a=>a.id!==m&&a.quantity>0);t&&(alert(t.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),t.value=Math.round(t.value*.95),p())}},6e4)},Math.random()*2e4),document.getElementById("add-to-cart").addEventListener("click",function(){const a=document.getElementById("product-select").value,n=I({productList:u,selectedItemId:a});if(v(n)){const i=document.getElementById(n.id);if(i){const c=parseInt(i.querySelector("span").textContent.split("x ")[1])+1;$({selectedProduct:n,nextQuantity:c,updateCartItems:D})}else L({selectedProduct:n});h(),f(),y(),m=n.id}}),document.getElementById("cart-items").addEventListener("click",w)}b();function B(){const e=document.getElementById("app"),o=document.createElement("div");o.className="bg-gray-100 p-8";const t=document.createElement("div");t.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8";const a=document.createElement("h1");a.className="text-2xl font-bold mb-4",a.textContent="장바구니";const n=document.createElement("div");n.id="cart-items";const i=document.createElement("div");i.id="cart-total";const c=document.createElement("select");c.id="product-select";const d=document.createElement("button");d.id="add-to-cart";const l=document.createElement("div");l.id="stock-status",i.className="text-xl font-bold my-4",c.className="border rounded p-2 mr-2",d.className="bg-blue-500 text-white px-4 py-2 rounded",l.className="text-sm text-gray-500 mt-2",d.textContent="추가",t.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(c),t.appendChild(d),t.appendChild(l),o.appendChild(t),e.appendChild(o)}function p(){const e=document.getElementById("product-select");e.innerHTML="",u.forEach(function(o){const t=document.createElement("option");t.value=o.id,t.textContent=`${o.name} - ${o.value}원`,o.quantity===0&&(t.disabled=!0),e.appendChild(t)})}function f(){const e=document.getElementById("stock-status");let o="";u.forEach(function(t){t.quantity<5&&(o+=`${t.name}: ${t.quantity>0?`재고 부족 (${t.quantity}개 남음)`:"품절"}
`)}),e.textContent=o}function L({selectedProduct:e}){const o=document.getElementById("cart-items"),t=document.createElement("div");t.id=e.id,t.className="flex justify-between items-center mb-2",t.innerHTML=`
    <span>${e.name} - ${e.value}원 x 1</span>
    <div>
      <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="-1">-</button>
      <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="1">+</button>
      <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${e.id}">삭제</button>
    </div>`,o.appendChild(t),e.quantity--}function y(){const e=document.getElementById("cart-total"),o=Math.floor(s/1e3);let t=document.getElementById("loyalty-points");t||(t=document.createElement("span"),t.id="loyalty-points",t.className="text-blue-500 ml-2",e.appendChild(t)),t.textContent=`(포인트: ${o})`}function h(){s=0;let e=0;const t=document.getElementById("cart-items").children;let a=0;[...t].forEach(c=>{const d=u.find(N=>N.id===c.id),l=parseInt(c.querySelector("span").textContent.split("x ")[1]),g=d.value*l,x=l>=10?q[d.id]:0;e+=l,a+=g,s+=g*(1-x)});let n=0;if(e>=C){const c=s*r,d=a-s;c>d?(s=a*(1-r),n=r):n=(a-s)/a}else n=(a-s)/a;new Date().getDay()===2&&(s*=1-.1,n=Math.max(n,.1));const i=document.getElementById("cart-total");if(i.textContent="총액: "+Math.round(s)+"원",n>0){const c=document.createElement("span");c.className="text-green-500 ml-2",c.textContent="("+(n*100).toFixed(1)+"% 할인 적용)",i.appendChild(c)}}function $({selectedProduct:e,nextQuantity:o,updateCartItems:t}){o<=e.quantity?t({selectedProduct:e,nextQuantity:o}):alert("재고가 부족합니다.")}function D({selectedProduct:e,nextQuantity:o}){const t=document.getElementById(e.id);t.querySelector("span").textContent=`${e.name} - ${e.value}원 x ${o}`,e.quantity--}function w(e){const o=e.target;if(!o.classList.contains("quantity-change")&&!o.classList.contains("remove-item"))return;const t=o.dataset.productId,a=document.getElementById(t),n=u.find(c=>c.id===t),i=parseInt(a.querySelector("span").textContent.split("x ")[1]);if(o.classList.contains("quantity-change")){const c=parseInt(o.dataset.change),d=i+c;E({curQuantity:i,quantityOffset:c,productQuantity:n.quantity})?(a.querySelector("span").textContent=`${n.name} - ${n.value}원 x ${d}`,n.quantity-=c):d<=0?(a.remove(),n.quantity-=c):alert("재고가 부족합니다.")}else o.classList.contains("remove-item")&&(n.quantity+=i,a.remove());h(),f(),y()}
